<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Secure Credential Transfer</title>
<meta content="Dmitry Vinokurov" name="author">
<meta content="B. Chester" name="author">
<meta content="Matthias Lerch" name="author">
<meta content="
       This document describes a mechanism to transfer digital credentials securely between two devices
Secure credentials may represent a digital key to a hotel room, a digital key to a door lock in a house 
or a digital key to a car. Devices that share credentials may belong to the same or two different platforms (e.g. iOS and Android).
Secure transfer may include one or more write and read operations.
Credentials transfer needs to be performed securely due to the sensitive nature of the information. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-securecredential-transfer-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.9.5
    appdirs 1.4.4
    ConfigArgParse 1.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.0
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 52.0.0
    six 1.15.0
-->
<link href="draft-secure-credential-transfer.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  scrollbar-color: #bbb #eee;
}
@media (prefers-color-scheme: dark) {
html {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
#title, #rfcnum {
  margin: 1.5em 0 0.2em;
}
#rfcnum + #title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Secure Credential Transfer</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Vinokurov, et al.</td>
<td class="center">Expires 14 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TODO Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-securecredential-transfer-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-11" class="published">11 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-14">14 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Vinokurov</div>
<div class="org">Apple Inc</div>
</div>
<div class="author">
      <div class="author-name">B. Chester</div>
<div class="org">Apple Inc</div>
</div>
<div class="author">
      <div class="author-name">M. Lerch</div>
<div class="org">Apple Inc</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Secure Credential Transfer</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a mechanism to transfer digital credentials securely between two devices
Secure credentials may represent a digital key to a hotel room, a digital key to a door lock in a house 
or a digital key to a car. Devices that share credentials may belong to the same or two different platforms (e.g. iOS and Android).
Secure transfer may include one or more write and read operations.
Credentials transfer needs to be performed securely due to the sensitive nature of the information.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 14 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-credential-transfer-workflo" class="xref">Credential transfer workflows</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-stateless-workflow" class="xref">Stateless workflow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-stateful-workflow" class="xref">Stateful workflow</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-api-connection-details" class="xref">API connection details</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-http-headers-x-correlation-" class="xref">HTTP Headers: X-Correlation-ID</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-http-access-methods" class="xref">HTTP access methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-createmailbox" class="xref">CreateMailbox</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-endpoint" class="xref">Endpoint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-request-parameters" class="xref">Request Parameters:</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="xref">6.1.3</a>.  <a href="#name-consumes" class="xref">Consumes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.4">
                    <p id="section-toc.1-1.6.2.1.2.4.1"><a href="#section-6.1.4" class="xref">6.1.4</a>.  <a href="#name-request-body" class="xref">Request body</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.5">
                    <p id="section-toc.1-1.6.2.1.2.5.1"><a href="#section-6.1.5" class="xref">6.1.5</a>.  <a href="#name-responses" class="xref">Responses</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-updatemailbox" class="xref">UpdateMailbox</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-endpoint-2" class="xref">Endpoint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-request-parameters-2" class="xref">Request Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="xref">6.2.3</a>.  <a href="#name-consumes-2" class="xref">Consumes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="xref">6.2.4</a>.  <a href="#name-request-body-2" class="xref">Request body</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.5">
                    <p id="section-toc.1-1.6.2.2.2.5.1"><a href="#section-6.2.5" class="xref">6.2.5</a>.  <a href="#name-responses-2" class="xref">Responses</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-deletemailbox" class="xref">DeleteMailbox</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-endpoint-3" class="xref">Endpoint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="xref">6.3.2</a>.  <a href="#name-request-parameters-3" class="xref">Request Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="xref">6.3.3</a>.  <a href="#name-responses-3" class="xref">Responses</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-readdisplayinformationfromm" class="xref">ReadDisplayInformationFromMailbox</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="xref">6.4.1</a>.  <a href="#name-endpoint-4" class="xref">Endpoint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="xref">6.4.2</a>.  <a href="#name-request-parameters-4" class="xref">Request Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.3">
                    <p id="section-toc.1-1.6.2.4.2.3.1"><a href="#section-6.4.3" class="xref">6.4.3</a>.  <a href="#name-responses-4" class="xref">Responses</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Today, there is no standard way of transferring digital credentials securely between two devices 
belonging to the same platform or two different platforms. This document proposes a solution to this problem 
by introducing a Relay server which allows devices to exchange encrypted Provisioning Information securely.
The Relay server solves this problem by creating and managing temporary mailbox storage.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Each mailbox can be referenced by devices from a unique mailbox identifier in a URL.
The URL pointing to encrypted Provisioning Information is to be passed between devices directly 
over various channels (e.g. SMS, email, messaging applications).
The exchange of the URL is outside of the scope of this document.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document describes a Hypertext (HTTP) Application Programming Interface (API) that allows 
Sender and Receiver devices to interact with a Relay server in order to perform secure credential transfer.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL</span>
NOT", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">Relay Server - Web application exposing Secure Credential Transfer API to remote devices. It serves to securily transfer Provisioning Information between two remote devices.<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.2">Sender device - a remote device initiating a transfer of Provisioning Information to another remote device (Receiver) so that Receiver can provision these credentials.<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.3">Receiver device - a remote device that receives Provisioning Information from Sender and uses it to provision Credentials Information to an application running on it.<a href="#section-2-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.4">Provisioning Partner - Third party Partner that owns, manages, accepts and revokes Credential Information on a remote device (Sender or Receiver).<a href="#section-2-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.5">Provisioning Information - a set of data fields, allowing a device to receive Credential Information from Provisioning Partner and install it locally. The entire content of Provisioning Information is encrypted by Sender or Receiver device. Therefore, it is not visible to Relay Server.<a href="#section-2-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.6">Provisioning Information - a set of data fields allowing a device to receive Credential Information from Provisioning Partner and install it locally. The entire content of Provisioning info is encrypted be Sender or Receiver device; therefore, is not visible to Relay Server<a href="#section-2-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.7">Credential Information - a set of data fields used to provision an access credential on the receiver's device.<a href="#section-2-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.8">Transaction Information - information data structure generated by Receiver device required to start provisioning in the stateful flow. It includes cryptographic keys generated by Receiver device. Sender device needs to approve (sign) Transaction Information before Receiver can start provisioning. Exact content of Transaction Information is specific for each Provisioning Partner and out of scope of this document.<a href="#section-2-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.9">Secret - a symmetric encryption key shared by a pair of a Sender and a Receiver devices, used to encrypt Provisioning Information stored on a Relay server. Secret stays the same for the entire credential transfer flow (one Secret per complete transfer). All information stored on Relay server is always encrypted using the Secret. In Stateful flow all information exchanged by Sender and Receiver devices throug Relay server is encrypted with the same Secret. Thus, effectively, Secret has a one-to-one relation with the mailbox.<a href="#section-2-2.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.10">Device Claim - a unique token allowing caller to read from /write to data the mailbox. Exactly one sender device and one receiver device should be able to read from/write secure payload to the mailbox. Sender device provides a deviceClaim in order to create a mailbox or update mailbox data and Relay server binds this Sender's Device Claim to the mailbox. When the receiver device first reads data from the mailbox it presents its Device Claim to the Relay Server, which binds the mailbox to the given Receiver device. Thus both Sender and Receiver devices are bound to the mailbox (allowed to read from/write to it). Only Sender/Receiver devices that can present valid Device Claims are allowed to send subsequent read/write/update/delete calls to the mailbox. The value shall be a UUID <span>[<a href="#RFC4122" class="xref">RFC4122</a>]</span>.<a href="#section-2-2.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.11">Notification Token - a short or long-lived unique token stored by the Sender or Receiver device in a mailbox on the Relay server, which allows Relay server to send a push notification message to the Sender or Receiver device, informing them on data update in the mailbox.<a href="#section-2-2.11" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="credential-transfer-workflows">
<section id="section-3">
      <h2 id="name-credential-transfer-workflo">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-credential-transfer-workflo" class="section-name selfRef">Credential transfer workflows</a>
      </h2>
<p id="section-3-1">We define two flows for credential transfer: 1. Stateless (Relay server facilitates a single credential data transfer: Sender -&gt; Relay -&gt; Receiver) and 2. Stateful (Relay facilitates additional datat transfers - there are 3 data exchanges in this flow to prepare credential data for provisioning by Receiver). The details are provided below.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="stateless-workflow">
<section id="section-3.1">
        <h3 id="name-stateless-workflow">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-stateless-workflow" class="section-name selfRef">Stateless workflow</a>
        </h3>
<p id="section-3.1-1">Stateless process starts with a Sender device composing a set of Provisioning Information, encrypting it with a Secret (symmetric data encryption key) and storing encrypted Provisioning Information on a Relay server in a mailbox. A unique mailbox identifier is generated by a Sender device as UUID that conforms to RFC 4122 version 4, created using good source of entropy (peferrably hardware-based entropy). Sender device generates a unique token - a Sender Device Claim - and stores it to the mailbox. Device Claim allows the Sender device presenting it to read and write data to/from the mailbox, thus binding it to the mailbox.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Sender device sends mailboxIdentifier to the Relay server as a part of CreateMailbox request.
Once mailbox is created, it has limited time to live. When expired, mailbox shall be deleted - refer to DeleteMailbox endpoint. Default expiration period has to be configured on the Relay server.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Relay server builds a unique URL link to a mailbox (for example, "http://relayserver.com/mailbox/1234567890") and returns it to the Sender device, which sends the link directly to the Receiver device over communication channel (e.g. SMS, email, iMessage).
In addition to that, Sender device passes the Secret to the Receiver device either through the same channel (in the same message as the URL) or over a different channel.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">Receiver device, having obtained both the URL link and the Secret,  generates a unique token - Receiver Device Claim - and passes it to the Relay server in order to reads the encrypted Provisioning Information from the mailbox.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">Relay server now binds a given pair of Sender a Receiver devices to the mailbox by provided Sender and Receiver Device Claims. Only bound devices are allowed to read or write data to the mailbox or to delete the mailbox.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">Receiver device, having read the encrypted Provisioning Information from the Relay mailbox, decrypts it with the Secret received  from the Sender and starts credential provisioning process on the device. Once the Receiver device has successfully provisioned credentials, it deletes the mailbox by sending a DeleteMailbox call to the Relay server.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<span id="name-sample-flow-of-stateless-pr"></span><div id="stateless-flow-image">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-3.1-7.1">
<pre>
                      Sender              Relay                          Receiver
                        |                   |                               |
    Create and encrypt  |                   |                               |
    Provisioning Info   |——----------------&gt;|                               |
                        |    CreateMailbox  |                               |
                        |&lt;------------------|                               |
                        |URL link to mailbox|                               |
    Send URL link       |                   |                               |
    and Secret          |--------------------------------------------------&gt;|
                        |                   | ReadSecureContent FromMailbox |
                        |                   |&lt;------------------------------|
                        |                   |                               | Decrypt Provisioning Info with Secret
                        |                   |                               |
                        |                   |                               | Provision credentials
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-sample-flow-of-stateless-pr" class="selfRef">Sample flow of stateless process</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="stateful-workflow">
<section id="section-3.2">
        <h3 id="name-stateful-workflow">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-stateful-workflow" class="section-name selfRef">Stateful workflow</a>
        </h3>
<p id="section-3.2-1">Stateful process includes additional steps to exchange the Provisioning Information, resulting in three data exchanges between Sender and Receiver.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The process starts with a Sender device building and encrypting Provisioning Information, storing it on a Relay server in a unique mailbox. A unique mailbox identifier is generated by the Sender device as UUID that conforms to RFC 4122 version 4, created from random data with good source of entropy (peferrably hardware-based entropy).<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">In addition to encrypted Provisioning Information, Sender stores a Sender Notification Token in the mailbox, which allows Relay server to send a notification message to the Sender device. Sender device generates a unique token - a Sender Device Claim - and stores it to the mailbox. Device Claim allows the Sender device presenting it to read and write data to/from the mailbox, thus binding it to the mailbox.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Sender device sends mailboxIdentifier to the Relay server as a part of CreateMailbox request.
Once mailbox is created, it has limited time to live. When expired, mailbox shall be deleted - refer to DeleteMailbox endpoint. Default expiration period has to be configured on the Relay server.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">Relay server builds a unique URL link to a mailbox (for example, "http://relayserver.com/mailbox/1234567890") and returns it to the Sender device, which sends the link directly to the Receiver device over communication channel (e.g. SMS, email, iMessage).
In addition to the URL link, Sender device passes a Secret (e.g. symmetric encryption key) to the Receiver device either through the same channel (in the same message as the URL) or over a different channel.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">Receiver device, having obtained both the URL link and the Secret,  generates a unique token - Receiver Device Claim - and passes it to the Relay server in order to read the encrypted Provisioning Information from the mailbox.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">Relay server now binds a given pair of Sender a Receiver devices to the mailbox by provided Sender and Receiver Device Claims. Only bound devices are allowed to read or write data to the mailbox or to delete the mailbox.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">Then the Receiver device, having downloaded the encrypted Provisioning Information from the mailbox by URL and decrypted it with the secret,  generates Transaction Information data structure and builds the following set of data fields:<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-9.1">Transaction Information<a href="#section-3.2-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-9.2">Receiver Notification Token which allows the Relay server to send notification messages to the Receiver device.<a href="#section-3.2-9.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-10">Receiver device adds the two fields above to the original Provisioning Information, encrypts them using the Secret received from Sender device, then stores all in the same mailbox on the Relay server.  Having received the encrypted Transaction Information, the Relay server sends a Notification to the Sender device using the Sender Notification Token.<a href="#section-3.2-10" class="pilcrow">¶</a></p>
<p id="section-3.2-11">Sender device, having received the notification from the Relay server, reads secure content from the mailbox and decrypts all using the same Secret. Sender device generates a digital signature over the Receiver's Transaction Information, appends it to the Provisioning Information and Receiver's Transaction Information fields, encrypts all these fields using the Secret and stores all data in the mailbox on the Relay server.<a href="#section-3.2-11" class="pilcrow">¶</a></p>
<p id="section-3.2-12">Relay server, having stored the data above, sends a notification message to the Receiver device using Receiver Notification Token. Receiver device, having received the notification, reads the encrypted Provisioning Information, Receiver's Transaction Information and Sender's Signature over the Transaction Information, decrypts all three fields using the same Secret and uses this data to start credential provisioning on device.<a href="#section-3.2-12" class="pilcrow">¶</a></p>
<p id="section-3.2-13">Once the Receiver device has successfully provisioned credentials, it deletes the mailbox by sending a DeleteMailbox call to the Relay server.
Sender device may terminate the secure credential transfer by deleting the mailbox it created at any time. Deletion of the mailbox on Relay server stops any on-going credential transfer process.<a href="#section-3.2-13" class="pilcrow">¶</a></p>
<span id="name-sample-flow-of-stateful-pro"></span><div id="stateful-flow-image">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.2-14.1">
<pre>
                     Sender                       Relay                     Receiver
                        |                            |                            |
    Create and encrypt  |    CreateMailbox           |                            |
    Provisioning Info   |---------------------------&gt;|                            |
                        |    encrypted info          |                            |
                        |&lt;---------------------------|                            |
                        |   URL link to mailbox      |                            |
                        |                            |                            |
    Send URL link       |--------------------------------------------------------&gt;|
    and Secret          |                            |ReadSecureContentFromMailbox|
                        |                            |                            |
                        |                            |&lt;---------------------------| Decrypt w Secret,
                        |                            |    encrypted info          |
                        |                            |    UpdateMailbox           | TxInfo=Generate TxInfo,
                        |                            |&lt;---------------------------| encrypted info =
                        |ReadSecureContentFromMailbox|       encrypted info       | encrypt(ProvInfo,TxInfo)
                        |                            |  (ProvInfo + TxInfo)       | with Secret
    Sign TxInfo         |---------------------------&gt;|                            |
    with OwnerKey,      |       encrypted info       |                            |
    encrypted info =    |                            |                            |
    encrypt(ProvInfo,   |     UpdateMailbox          |                            |
    TxInfo,Signature)   |—-----------—--------------&gt;|ReadSecureContentFromMailbox|
    with Secret         |    encrypted info          |                            |
                        |                            |&lt;---------------------------| Decrypt(ProvInfo,TxInfo,
                        |                            |  encrypted info            | Signature)
                        |                            |                            | Provision credentials
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-sample-flow-of-stateful-pro" class="selfRef">Sample flow of stateful process</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="api-connection-details">
<section id="section-4">
      <h2 id="name-api-connection-details">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-api-connection-details" class="section-name selfRef">API connection details</a>
      </h2>
<p id="section-4-1">The Relay server API endpoint <span class="bcp14">MUST</span> be accessed over HTTP using an https URI <span>[<a href="#RFC2818" class="xref">RFC2818</a>]</span> and <span class="bcp14">SHOULD</span> use the default https port. 
Request and response bodies shall be formatted as either JSON or HTML (based on the API endpoint). The communication protocol used for all interfaces shall be HTTPs.
All Strings shall be UTF-8 encoded (Unicode Normalization Form C (NFC)).
An API version shall be included in the URI for all interfaces. The version at the time of this document's latest update is v1. The version shall be incremented by 1 for major API changes or backward incompatible iterations on existing APIs.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-headers-x-correlation-id">
<section id="section-5">
      <h2 id="name-http-headers-x-correlation-">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-http-headers-x-correlation-" class="section-name selfRef">HTTP Headers: X-Correlation-ID</a>
      </h2>
<p id="section-5-1">All requests to and from Relay server will have an HTTP header "X-Correlation-ID". The corresponding response to the API will have the same HTTP header "X-Correlation-ID", which should echo the value in the request header. This is used to identify the request associated to the response for a particular API request and response pair. The value shall be a UUID of length 36 containing hyphens.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-access-methods">
<section id="section-6">
      <h2 id="name-http-access-methods">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-http-access-methods" class="section-name selfRef">HTTP access methods</a>
      </h2>
<div id="createmailbox">
<section id="section-6.1">
        <h3 id="name-createmailbox">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-createmailbox" class="section-name selfRef">CreateMailbox</a>
        </h3>
<p id="section-6.1-1">An application running on a remote device can invoke this API on Relay Server to create a mailbox and store secure data content to it (encrypted data specific to a provisioning partner).<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div id="endpoint">
<section id="section-6.1.1">
          <h4 id="name-endpoint">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-endpoint" class="section-name selfRef">Endpoint</a>
          </h4>
<p id="section-6.1.1-1">POST  /{version}/mailbox<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request-parameters">
<section id="section-6.1.2">
          <h4 id="name-request-parameters">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-request-parameters" class="section-name selfRef">Request Parameters:</a>
          </h4>
<p id="section-6.1.2-1">Path parameters<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-2.1">version (String, Required) - the version of the API. At the time of writing this document, "v1".<a href="#section-6.1.2-2.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.1.2-3">Header parameters<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-4.1">deviceAttestation (String, Optional) - optional remote device-specific attestation data.<a href="#section-6.1.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.2-4.2">deviceClaim (String, UUID, Required) - Device Claim (refer to Terminology).<a href="#section-6.1.2-4.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="consumes">
<section id="section-6.1.3">
          <h4 id="name-consumes">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-consumes" class="section-name selfRef">Consumes</a>
          </h4>
<p id="section-6.1.3-1">This API call consumes the following media types via the Content-Type request header: <code>application/json</code><a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request-body">
<section id="section-6.1.4">
          <h4 id="name-request-body">
<a href="#section-6.1.4" class="section-number selfRef">6.1.4. </a><a href="#name-request-body" class="section-name selfRef">Request body</a>
          </h4>
<p id="section-6.1.4-1">Request body is a complex structure, including the following fields:<a href="#section-6.1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.4-2.1">mailboxIdentifier (String, Required) - a unique identifier of the mailbox to be created.<a href="#section-6.1.4-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.4-2.2">payload (String, Required) - for the purposes of Secure Credential Transfer API, this is a JSON metadata blob, describing Provisioning Information specific to Credential Provider.<a href="#section-6.1.4-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.4-2.3">displayInformation (String, Required) - for the purposes of the Secure Credential Transfer API, this is a JSON data blob. It allows an application running on a receiving device to build a visual representation of the credential to show to user. Specific to Credential Provider.<a href="#section-6.1.4-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.4-2.4">
              <p id="section-6.1.4-2.4.1">notificationToken (Object, Optional) - optional notification token used to notify an appropriate remote device that the mailbox data has been updated. Data structure includes the following:<a href="#section-6.1.4-2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1.4-2.4.2">
<li id="section-6.1.4-2.4.2.1">type (String, Required) - notification token name. Used to define which Push Notification System to be used to notify appropriate remote device of a mailbox data update. (E.g. "com.apple.apns" for APNS)<a href="#section-6.1.4-2.4.2.1" class="pilcrow">¶</a>
</li>
                <li id="section-6.1.4-2.4.2.2">tokenData (String, Required) - notification token data (Hex or Base64 encoded based on the concrete implementation) - application-specific - refer to appropriate Push Notification System specification.<a href="#section-6.1.4-2.4.2.2" class="pilcrow">¶</a>
</li>
              </ol>
</li>
            <li class="normal" id="section-6.1.4-2.5">
              <p id="section-6.1.4-2.5.1">mailboxConfiguration (Object, Optional) - optional mailbox configuration, defines access rights to the mailbox, mailbox expirationTime. Required at the time of the mailbox creation. Data structure includes the following:<a href="#section-6.1.4-2.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1.4-2.5.2">
<li id="section-6.1.4-2.5.2.1">accessRights (String, Optional) - optional access rights to the mailbox for Sender and  Receiver devices. Default access to the mailbox is Read and Delete. 
Value is defined as a combination of the following values: "R" - for read access, "W" - for write access, "D" - for delete access. Example" "RD" - allows to read from the mailbox and delete it.<a href="#section-6.1.4-2.5.2.1" class="pilcrow">¶</a>
</li>
                <li id="section-6.1.4-2.5.2.2">expirationTime (String, optional) - Mailbox expiration time (UTC). E.g. "2021-07-22T13:14:15Z". Mailbox has a limited time to live. Once expired, it shall be deleted - refer to DeleteMailbox endpoint. Default expiration period has to be configured on the Relay server.<a href="#section-6.1.4-2.5.2.2" class="pilcrow">¶</a>
</li>
              </ol>
</li>
          </ul>
<span id="name-apple-push-token-example"></span><div id="apple-push-token">
<figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-6.1.4-3.1">
<pre>
{
   "notificationToken": {
        "name":"com.apple.apns",
        "tokenData":"APNS1234...QW"
    }
}
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-apple-push-token-example" class="selfRef">Apple Push Token Example</a>
            </figcaption></figure>
</div>
<span id="name-create-mailbox-request-exam"></span><div id="create-mailbox-request">
<figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-6.1.4-4.1">
<pre>
{    "mailboxIdentifier" : "12345678-9...A-BCD",
    "displayInformation" : {
        "title" : "Hotel Pass",
        "description" : "Some Hotel Pass",
        "imageURL" : "https://hotel.com/sharingImage"
    },
    "payload" : "FDEC...987654321",
    "notificationToken" : {
        "type" : "com.apple.apns",
        "tokenData" : “APNS...1234"
    },
    "mailboxConfiguration" : {
        "accessRights" : "RWD",
        "expirationTime" : "2021-01-01 01:01:01”
    }
}
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-create-mailbox-request-exam" class="selfRef">Create Mailbox Request Example</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="responses">
<section id="section-6.1.5">
          <h4 id="name-responses">
<a href="#section-6.1.5" class="section-number selfRef">6.1.5. </a><a href="#name-responses" class="section-name selfRef">Responses</a>
          </h4>
<p id="section-6.1.5-1"><code>200</code>
Status: "200" (OK)<a href="#section-6.1.5-1" class="pilcrow">¶</a></p>
<p id="section-6.1.5-2">ResponseBody:
- urlLink (String, Required) - a full URL link to the mailbox including fully qualified domain name and mailbox dientifier.<a href="#section-6.1.5-2" class="pilcrow">¶</a></p>
<span id="name-create-mailbox-response-exa"></span><div id="create-mailbox-response">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-6.1.5-3.1">
<pre>
{
    "urlLink":"relay.com/mailbox/12345678-9...A-BCD"
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-create-mailbox-response-exa" class="selfRef">Create Mailbox Response Example</a>
            </figcaption></figure>
</div>
<p id="section-6.1.5-4"><code>400</code>
Bad Request - invalid request has been passed (can not parse or required fields missing).<a href="#section-6.1.5-4" class="pilcrow">¶</a></p>
<p id="section-6.1.5-5"><code>401</code>
Unauthorized - calling device is not authorized to create a mailbox. E.g. a device presented the incorrect deviceClaim or mailbox with the provided mailboxIdentifier already exists.<a href="#section-6.1.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="updatemailbox">
<section id="section-6.2">
        <h3 id="name-updatemailbox">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-updatemailbox" class="section-name selfRef">UpdateMailbox</a>
        </h3>
<p id="section-6.2-1">An application running on a remote device can invoke this API on Relay Server to update secure data content in an existing mailbox (encrypted data specific to a Provisioning Partner).<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="endpoint-1">
<section id="section-6.2.1">
          <h4 id="name-endpoint-2">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-endpoint-2" class="section-name selfRef">Endpoint</a>
          </h4>
<p id="section-6.2.1-1">PUT  /{version}/mailbox/{mailboxIdentifier}<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request-parameters-1">
<section id="section-6.2.2">
          <h4 id="name-request-parameters-2">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-request-parameters-2" class="section-name selfRef">Request Parameters</a>
          </h4>
<p id="section-6.2.2-1">Path parameters:<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-2.1">version (String, Required) - the version of the API. At the time of writing this document, "v1".<a href="#section-6.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.2-2.2">mailboxIdentifier(String, Required) - Sender device-defined unique identifier for the given mailbox. The value shall be a UUID of length 36 containing hyphens.<a href="#section-6.2.2-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.2-3">Header parameters:<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-4.1">deviceAttestation (String, Optional) - optional remote device-specific attestation data.<a href="#section-6.2.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.2-4.2">deviceClaim (String, UUID, Required) - Device Claim (refer to Terminology).<a href="#section-6.2.2-4.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="consumes-1">
<section id="section-6.2.3">
          <h4 id="name-consumes-2">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-consumes-2" class="section-name selfRef">Consumes</a>
          </h4>
<p id="section-6.2.3-1">This API call consumes the following media types via the Content-Type request header: <code>application/json</code><a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request-body-1">
<section id="section-6.2.4">
          <h4 id="name-request-body-2">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-request-body-2" class="section-name selfRef">Request body</a>
          </h4>
<p id="section-6.2.4-1">Request body is a complex structure, including the following fields:<a href="#section-6.2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.4-2.1">payload (String, Required) - for the purposes of Secure Credential Transfer API, this is a JSON metadata blob, describing Provisioning Information specific to Credential Provider.<a href="#section-6.2.4-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.4-2.2">displayInformation (String, Required) - for the purposes of the Secure Credential Transfer API, this is a JSON data blob. It allows an application running on a receiving device to build a visual representation of the credential to show to user. Specific to Credential Provider.<a href="#section-6.2.4-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.4-2.3">notificationToken (Object, Optional) - Optional notification token used to notify an appropriate remote device that the mailbox data has been updated. Data structure includes the following:
      - type (String, Required) - notification token name. Used to define which Push Notification System to be used to notify appropriate remote device of a mailbox data update. (E.g. "com.apple.apns" for APNS)
      - tokenData (String, Required) - notification token data (Hex or Base64 encoded based on the concrete implementation) - application-specific - refer to appropriate Push Notification System specification<a href="#section-6.2.4-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-update-mailbox-request-exam"></span><div id="update-mailbox-request">
<figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-6.2.4-3.1">
<pre>
{
    "displayInformation" : {
        "title" : "Hotel Pass",
        "description" : "Some Hotel Pass",
        "imageURL" : "https://hotel.com/sharingImage"
    },
    "payload" : "FDEC...987654321",
    "notificationToken":{
        "type" : "com.apple.apns",
        "tokenData" : “APNS...1234"
    }
}
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-update-mailbox-request-exam" class="selfRef">Update Mailbox Request Example</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="responses-1">
<section id="section-6.2.5">
          <h4 id="name-responses-2">
<a href="#section-6.2.5" class="section-number selfRef">6.2.5. </a><a href="#name-responses-2" class="section-name selfRef">Responses</a>
          </h4>
<p id="section-6.2.5-1"><code>200 </code>
Status: "200" (OK)<a href="#section-6.2.5-1" class="pilcrow">¶</a></p>
<p id="section-6.2.5-2"><code>400</code>
Bad Request - invalid request has been passed (can not parse or required fields missing).<a href="#section-6.2.5-2" class="pilcrow">¶</a></p>
<p id="section-6.2.5-3"><code>401</code>
Unauthorized - calling device is not authorized to create a mailbox. E.g. a device presented the incorrect deviceClaim.<a href="#section-6.2.5-3" class="pilcrow">¶</a></p>
<p id="section-6.2.5-4"><code>404</code>
Not Found - mailbox with provided mailboxIdentifier not found.<a href="#section-6.2.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="deletemailbox">
<section id="section-6.3">
        <h3 id="name-deletemailbox">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-deletemailbox" class="section-name selfRef">DeleteMailbox</a>
        </h3>
<p id="section-6.3-1">An application running on a remote device can invoke this API on Relay Server to close the existing mailbox after it served its purpose. Receiver or Sender device needs to present a deviceClaim in order to close the mailbox. Upon closure, the mailbox shall still respond to GET operations, returning the OpenGraph displayInformation.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div id="endpoint-2">
<section id="section-6.3.1">
          <h4 id="name-endpoint-3">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-endpoint-3" class="section-name selfRef">Endpoint</a>
          </h4>
<p id="section-6.3.1-1">DELETE /{version}/mailbox/{mailboxIdentifier}<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request-parameters-2">
<section id="section-6.3.2">
          <h4 id="name-request-parameters-3">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-request-parameters-3" class="section-name selfRef">Request Parameters</a>
          </h4>
<p id="section-6.3.2-1">Path parameters:<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.2-2.1">version (String, Required) - the version of the API. At the time of writing this document, "v1".<a href="#section-6.3.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.2-2.2">mailboxIdentifier(String, Required) - Sender device-defined unique identifier for the given mailbox. The value shall be a UUID of length 36 containing hyphens.<a href="#section-6.3.2-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.3.2-3">Header parameters:<a href="#section-6.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.2-4.1">deviceAttestation (String, Optional) - optional remote device-specific attestation data.<a href="#section-6.3.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.2-4.2">deviceClaim (String, UUID, Required) - Device Claim (refer to Terminology).<a href="#section-6.3.2-4.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="responses-2">
<section id="section-6.3.3">
          <h4 id="name-responses-3">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-responses-3" class="section-name selfRef">Responses</a>
          </h4>
<p id="section-6.3.3-1"><code>200</code>
Status: "200" (OK)<a href="#section-6.3.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3.3-2"><code>401</code>
Unauthorized - calling device is not authorized to create a mailbox. E.g. a device presented the incorrect deviceClaim.<a href="#section-6.3.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3.3-3"><code>404</code>
Not Found - mailbox with provided mailboxIdentifier not found.<a href="#section-6.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="readdisplayinformationfrommailbox">
<section id="section-6.4">
        <h3 id="name-readdisplayinformationfromm">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-readdisplayinformationfromm" class="section-name selfRef">ReadDisplayInformationFromMailbox</a>
        </h3>
<p id="section-6.4-1">An application running on a remote device can invoke this API on Relay Server to to retrieve public display information content from a mailbox. Application-specific (e.g. OpenGraph, JSON).<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div id="endpoint-3">
<section id="section-6.4.1">
          <h4 id="name-endpoint-4">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-endpoint-4" class="section-name selfRef">Endpoint</a>
          </h4>
<p id="section-6.4.1-1">GET /{version}/mailbox/{mailboxIdentifier}<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request-parameters-3">
<section id="section-6.4.2">
          <h4 id="name-request-parameters-4">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-request-parameters-4" class="section-name selfRef">Request Parameters</a>
          </h4>
<p id="section-6.4.2-1">Path parameters:<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4.2-2.1">version (String, Required)- the version of the API. At the time of writing this document, "v1".<a href="#section-6.4.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.4.2-2.2">mailboxIdentifier(String, Required) - Sender device-defined unique identifier for the given mailbox. The value shall be a UUID of length 36 containing hyphens.<a href="#section-6.4.2-2.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="responses-3">
<section id="section-6.4.3">
          <h4 id="name-responses-4">
<a href="#section-6.4.3" class="section-number selfRef">6.4.3. </a><a href="#name-responses-4" class="section-name selfRef">Responses</a>
          </h4>
<p id="section-6.4.3-1"><code>200</code>
Status: "200" (OK)<a href="#section-6.4.3-1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-2">ResponseBody :<a href="#section-6.4.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4.3-3.1">displayInformation (String, Required) - application-specific (e.g. OpenGraph, JSON) visual representation of digital credential.<a href="#section-6.4.3-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-read-display-information-re"></span><div id="read-display-information-response">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-6.4.3-4.1">
<pre>
    "&lt;html prefix="og: https://ogp.me/ns#"&gt;
     &lt;head&gt;
     &lt;title&gt;Hotel Pass&lt;/title&gt;
     &lt;meta property="og:title" content="Hotel Pass" /&gt;
     &lt;meta property="og:type" content="image/jpeg" /&gt;
     &lt;meta property="og:description" content="Some Hotel Pass" /&gt;
     &lt;meta property="og:url" content="share://" /&gt;
     &lt;meta property="og:image" content="https://website.com/photos/photo.jpg" /&gt;
     &lt;meta property="og:image:width" content="612" /&gt;
     &lt;meta property="og:image:height" content="408" /&gt;&lt;/head&gt;
     &lt;/html&gt;"
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-read-display-information-re" class="selfRef">Read Display Information Response Example</a>
            </figcaption></figure>
</div>
<p id="section-6.4.3-5"><code>401</code>
Unauthorized - calling device is not authorized to create a mailbox. E.g. a device presented the incorrect deviceClaim.<a href="#section-6.4.3-5" class="pilcrow">¶</a></p>
<p id="section-6.4.3-6"><code>404</code>
Not Found - mailbox with provided mailboxIdentifier not found.<a href="#section-6.4.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">This section discusses security considerations for the protocol.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-normative-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2818">[RFC2818]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"HTTP Over TLS"</span>, <span class="seriesInfo">RFC 2818</span>, <span class="seriesInfo">DOI 10.17487/RFC2818</span>, <time datetime="2000-05" class="refDate">May 2000</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc2818">https://datatracker.ietf.org/doc/html/rfc2818</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4122">[RFC4122]</dt>
      <dd>
<span class="refAuthor">Leach, P.</span>, <span class="refAuthor">Mealling, M.</span>, and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"A Universally Unique IDentifier (UUID) URN Namespace"</span>, <span class="seriesInfo">RFC 4122</span>, <span class="seriesInfo">DOI 10.17487/RFC4122</span>, <time datetime="2005-07" class="refDate">July 2005</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc4122">https://datatracker.ietf.org/doc/html/rfc4122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8174">https://datatracker.ietf.org/doc/html/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dmitry Vinokurov</span></div>
<div dir="auto" class="left"><span class="org">Apple Inc</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dvinokurov@apple.com" class="email">dvinokurov@apple.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">B. Chester</span></div>
<div dir="auto" class="left"><span class="org">Apple Inc</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bchester@add_email_here.apple.com" class="email">bchester@add_email_here.apple.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Matthias Lerch</span></div>
<div dir="auto" class="left"><span class="org">Apple Inc</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mlerch@add_email_here.apple.com" class="email">mlerch@add_email_here.apple.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
